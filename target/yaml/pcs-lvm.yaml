agents:
  - mgmtip: 10.5.41.10
    script: ./tgtagent.sh
    workdir: /tmp/target
    mode: active

name: copyset1
hosts:
  - name: n010
    authaddr: 10.5.41.10
    authuser: hacluster
    authpasswd: hapasswd

  - name: n034
    authaddr: 10.5.41.34
    authuser: hacluster
    authpasswd: hapasswd

stonith_enabled: false
stoniths:
  - name: n010
    ipmiaddr: 192.168.50.41
    ipmiuser: yulingz
    ipmipasswd: W68cfurjYV0314

  - name: n034
    ipmiaddr: 192.168.50.76
    ipmiuser: yulingz
    ipmipasswd: W68cfurjYV0314

resources:
  - name: nvmevol-mdraid
    ra: ocf:heartbeat:mdraid
    params:
      md_dev: /dev/md/nvmevol
      mdadm_conf: /etc/mdadm/nvmevg.conf

  - name: nvmevol-subsys
    ra: ocf:heartbeat:nvmet-subsystem
    params:
      nqn: ebcloud.com.nvmevol

  - name: nvmevol-ns
    ra: ocf:heartbeat:nvmet-namespace
    params:
      nqn: ebcloud.com.nvmevol
      backing_path: /dev/md/nvmevol
      namespace_id: 1
      uuid: c217653a-137f-4dd4-92a1-0193c63dc305

  - name: nvmevol-addr1
    ra: ocf:heartbeat:IPaddr2
    params:
      nic: ibp161s0
      ip: 10.2.1.201
      cidr_netmask: 32
      arp_sender: iputils_arping

  - name: nvmevol-port1
    ra: ocf:heartbeat:nvmet-port
    params:
      nqns: ebcloud.com.nvmevol
      port_id: 1
      type: rdma
      addr: 10.2.1.201
      svcid: 4420
      addr_fam: ipv4

  - name: nvmevol-addr2
    ra: ocf:heartbeat:IPaddr2
    params:
      nic: bond0
      ip: 10.5.41.201
      cidr_netmask: 32
      arp_sender: iputils_arping

  - name: nvmevol-port2
    ra: ocf:heartbeat:nvmet-port
    params:
      nqns: ebcloud.com.nvmevol
      port_id: 2
      type: tcp
      addr: 10.5.41.201
      svcid: 4420
      addr_fam: ipv4

  - name: scsivol-mdraid
    ra: ocf:heartbeat:mdraid
    params:
      md_dev: /dev/md/scsivol
      mdadm_conf: /etc/mdadm/scsivg.conf

  - name: scsivol-tgt
    ra: ocf:heartbeat:iSCSITarget
    params:
      implementation: 'lio-t'
      iqn: iqn.2024-04.com.ebcloud.scsivol-tgt
      portals: 10.5.41.201:3261

  - name: scsivol-lun
    ra: ocf:heartbeat:iSCSILogicalUnit
    params:
      target_iqn: iqn.2024-04.com.ebcloud.scsivol-tgt
      lun: 0
      path: /dev/md/scsivol

groups:
  - name: nvmevol-target-group
    locations: [ n010, n034 ]
    resources: [ nvmevol-mdraid, nvmevol-subsys, nvmevol-ns ]

  - name: nvmevol-port1-group
    predecessor: nvmevol-target-group
    resources: [ nvmevol-addr1, nvmevol-port1 ]

  - name: nvmevol-port2-group
    predecessor: nvmevol-target-group
    resources: [ nvmevol-addr2, nvmevol-port2 ]

  - name: scsivol-group
    locations: [ n010, n034 ]
    resources: [ scsivol-mdraid, scsivol-tgt, scsivol-lun ]
